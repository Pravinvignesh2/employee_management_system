<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <h1>Dashboard</h1>
    <button mat-raised-button color="primary" (click)="refreshData()" [disabled]="loading">
      <mat-icon>refresh</mat-icon>
      Refresh
    </button>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading dashboard data...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="error-container">
    <mat-card class="error-card">
      <mat-card-content>
        <mat-icon color="warn">error</mat-icon>
        <p>{{ error }}</p>
        <button mat-raised-button color="primary" (click)="refreshData()">Retry</button>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error" class="dashboard-content">
    
    <!-- Statistics Cards -->
    <div class="stats-grid">
      
      <!-- User Statistics -->
      <mat-card class="stat-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>people</mat-icon>
            Employee Statistics
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-item">
            <span class="stat-label">Total Employees:</span>
            <span class="stat-value">{{ userStatistics?.totalUsers || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Active Employees:</span>
            <span class="stat-value">{{ userStatistics?.activeUsers || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">New Hires (This Month):</span>
            <span class="stat-value">{{ userStatistics?.newHiresThisMonth || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Pending Approvals:</span>
            <span class="stat-value">{{ userStatistics?.pendingApprovals || 0 }}</span>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Attendance Statistics -->
      <mat-card class="stat-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>schedule</mat-icon>
            Attendance Statistics
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-item">
            <span class="stat-label">Present Today:</span>
            <span class="stat-value">{{ attendanceStatistics?.totalPresent || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Absent Today:</span>
            <span class="stat-value">{{ attendanceStatistics?.totalAbsent || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Half Day:</span>
            <span class="stat-value">{{ attendanceStatistics?.totalHalfDay || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Attendance Rate:</span>
            <span class="stat-value" [ngClass]="'text-' + getAttendanceRateColor()">
              {{ getAttendanceRate() | number:'1.1-1' }}%
            </span>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Leave Statistics -->
      <mat-card class="stat-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>event</mat-icon>
            Leave Statistics
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-item">
            <span class="stat-label">Total Leaves:</span>
            <span class="stat-value">{{ leaveStatistics?.totalLeaves || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Pending Leaves:</span>
            <span class="stat-value">{{ leaveStatistics?.pendingLeaves || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Approved Leaves:</span>
            <span class="stat-value">{{ leaveStatistics?.approvedLeaves || 0 }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Approval Rate:</span>
            <span class="stat-value" [ngClass]="'text-' + getLeaveApprovalRateColor()">
              {{ getLeaveApprovalRate() | number:'1.1-1' }}%
            </span>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Quick Actions -->
      <mat-card class="stat-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>flash_on</mat-icon>
            Quick Actions
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="quick-actions">
            <button mat-raised-button color="primary" class="action-btn">
              <mat-icon>person_add</mat-icon>
              Add Employee
            </button>
            <button mat-raised-button color="accent" class="action-btn">
              <mat-icon>approval</mat-icon>
              Approve Leaves
            </button>
            <button mat-raised-button color="warn" class="action-btn">
              <mat-icon>schedule</mat-icon>
              Mark Attendance
            </button>
            <button mat-raised-button class="action-btn">
              <mat-icon>assessment</mat-icon>
              View Reports
            </button>
          </div>
        </mat-card-content>
      </mat-card>

    </div>

    <!-- Charts Section -->
    <div class="charts-section">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Attendance Overview</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="chart-container">
            <canvas #attendanceChart></canvas>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Recent Activities -->
    <div class="recent-activities">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Recent Activities</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <mat-list>
            <mat-list-item *ngFor="let activity of recentActivities">
              <mat-icon matListItemIcon>{{ activity.icon }}</mat-icon>
              <div matListItemTitle>{{ activity.title }}</div>
              <div matListItemLine>{{ activity.description }}</div>
              <div matListItemMeta>{{ activity.time | date:'short' }}</div>
            </mat-list-item>
          </mat-list>
        </mat-card-content>
      </mat-card>
    </div>

  </div>
</div> 